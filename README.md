# moex_tracking_bot

# Кратное описание:
Телеграм-бот для отслеживания ситуации на рынке с помощью API Московской биржи. 
Он должен замечать большие покупки и большие продажи активов и уведомлять об этом пользователя, 
что может помочь пользователю при принятии решений о покупке или продаже активов.

# Функциональноть: 
1. /start - начать работу с ботом 
2. /help - посмотреть доступные команды

# Основные используемые библиотеки:
1. asyncio - библиотека для ассинхронного программирования
2. aiogram - удобный фреймворк для создания телеграмм-ботов
3. tradingview_ta - библиотека для технического анализа финансовых рынков
4. requests - библиотека для выполнения HTTP-запросов

# База данных:
Бот использует базу данных SQLite для хранения информации о компаниях и акциях, за которыми он следит.
Файл базы данных будет создан автоматически при первом запуске бота.

# Алгоритм:
Бот использует 2 различных алгоритма:
1. **own_recomendation** - не всегда присутсвует его результат в сообщении, а только в случаях очень "выгодной" ситуации. \
Изменение цены: >0.5%; Заявки на покупку: >70%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): <50%; Измнение объема: >0.5%; Технический индикатор [CCI](https://ru.wikipedia.org/wiki/Индекс_товарного_канала): <-100; Рекомендация: **SUPER STRONG BUY**; \
Изменение цены: >0.5%; Заявки на покупку: >70%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): <50%; Измнение объема: >0.3%; Рекомендация: **STRONG BUY**; \
Изменение цены: >0.5%; Заявки на покупку: >70%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): <50%; Измнение объема: >0.1%; Рекомендация: **BUY**; \
Изменение цены: >0.3%; Заявки на покупку: >60%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): <40%; Рекомендация: **BUY**; \
Изменение цены: <-0.5%; Заявки на продажу: >70%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): >50%; Измнение объема: >0.5%;; Технический индикатор [CCI](https://ru.wikipedia.org/wiki/Индекс_товарного_канала): >100; Рекомендация: **SUPER STRONG SELL**; \
Изменение цены: <-0.5%; Заявки на продажу: >70%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): >50%; Измнение объема: >0.3%;; Рекомендация: **STRONG SELL**; \
Изменение цены: <-0.5%; Заявки на продажу: >70%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): >50%; Измнение объема: >0.1%;; Рекомендация: **SELL**; \
Изменение цены: <-0.3%; Заявки на продажу: >60%; технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы): >60%; Рекомендация: **SELL**; 

2. **alg_sell_buy** - имеет 3 анализуемых параметра: изменение цены, актуальные предложения по покупке/продаже, технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы). Использует следующую логику:  \
Заводится переменная под результат. Каждый параметр может дать к сумме от -10 до 10 баллов. \
**2.1** **Изменение цены**: `min(int(difference_price * 10), 10)`. То есть изменение цены на +0.5% прибавит 5 баллов, -0.7% убавит 7 баллов; \
**2.2** **Актуальные предложения по покупке/продаже**: `int(deptht_(buy/sell) / 10)`. Если предложений на покупку больше, то добавится `(процент заявок на покупку) / 10`; `в противном  случае(процент заявок на продажу) / 10`; \
**2.3** **Технический индикатор [RSI](https://ru.wikipedia.org/wiki/Индекс_относительной_силы)**: если RSI < 50 (т.е. есть перепроданность), то добавится `int((100 - rsi) / 10)`; в противном случае `int(rsi / 10);` \
Всего можно получить от -30 до 30 баллов. Если модуль результата положительный, но меньше 10, то будет рекомдация **BUY/SELL**; если больше 10, но меньше 23, то будет рекомендация **STRONG BUY/STRONG SELL**. Иначе - **SUPER STRONG BUY/SUPER STRONG SELL**. \
\
\
**Пример работы:** \
\
\
Этот алгоритм помогает оценить ситуацию с конкретной акцией и предоставляет рекомендации по покупке/продаже на основе анализируемых параметров. \
Например, в ситуации, когда цена выросла на 0.7% (+7), но при этом заявок на продажу 70% (-7), а технический индикатор RSI 60 (-6), то результат будет -6, что даст рекомендацию на продажу (SELL). \
Можно предположить, что был определенный фактор (например, "положительная" новость), на фоне которого акцию начали активно покупать (рост цены). \
Но, некоторые участники торгов решили продать актив по выгодной цене (заявки на продажу). \
В этой ситуации помогает технический индикатор RSI, который покажет какая сейчас ситуация (перекупленность или перепроданность акции). \
\

Также в сообщении присутсвует аналитика по техническим индикаторам, которая формируется запросом `get_analysis().summary` библиотеки tradingview_ta. 

